<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Pybonacci">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>PFS: Multiplicación de Karatsuba | Pybonacci</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Pybonacci blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/fontello.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>.description-author {
  font-size: 0.8em;
  color: #333;
}
.img-author {
  max-height: 10em;
  max-width: 10em;
}
img[src$="centerme"] {
  display: block;
  margin: 0 auto;
}
body {
  margin: 0;
  padding: 0;
  font: 'Source Sans Pro', sans-serif;
  color: #222222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
@media all and (min-width: 960px) {
  body {
    font-size: 20px;
  }
}
@media all and (max-width: 959px) and (min-width: 600px) {
  body {
    font-size: 16px;
  }
}
@media all and (max-width: 599px) and (min-width: 320px) {
  body {
    font-size: 14px;
  }
}
div.input_area {
  font-size: 1.1em;
  margin: 0 10%;
}
div.output_area {
  font-size: 1.1em;
  margin: 0 10%;
}
div.output_subarea {
  max-width: 100% !important;
}
pre {
  font-size: 1.1em;
}
p {
  margin-bottom: 20px;
  line-height: 1.6em;
  text-align: justify;
}
img {
  display: block;
  margin-left: auto;
  margin-right: auto;
  max-width: 100%;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article .meta {
  margin-top: 35px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta address:before,
article .meta time:before,
article .meta a.tag:before {
  font-family: 'fontello';
  margin-right: 6px;
}
article .meta address.author {
  float: left;
}
article .meta address:before {
  content: '\e819';
}
article .meta time:before {
  content: '\f133';
}
article .meta div.tags {
  clear: both;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:before {
  content: '\e821';
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 1.5em;
  font-weight: 800;
  padding: 10px 20px;
  color: #007aa3;
  background: #FFF;
  border: 1px solid #007aa3;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #007aa3;
}
article .meta:after {
  content: "";
  display: table;
  clear: both;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script data-isso="https://comments.pybonacci.org"
                data-isso-lang="es"
                src="https://comments.pybonacci.org/js/embed.min.js"></script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        });
        MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>


        </script>

    </head>

    <body>
        <header class="navbar navbar-default bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Pybonacci</a><!-- — Python y Ciencia-->
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/acerca-de-pybonacci.html" title="About">Acerca de</a></li>
			    <li><a href="/pages/como-contribuir.html" title="Contributing">Contribuir</a></li>
                            <li><a href="/archives.html" title="Archive">Archivos</a></li>
                            <li><a class="nodec icon-rss" href="/feeds/all.atom.xml" title="pybonacci.github.io RSS feed" rel="me"></a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>PFS: Multiplicación de Karatsuba</h1>
            <div class="meta">
                <time datetime="article.date.isoformat()" pubdate>mié 04 septiembre 2013</time>
                <address class="vcard author">Por
                    <a class="url fn" href="http://pybonacci.github.io/author/kiko-correoso.html">Kiko Correoso</a>
                </address>
            </div>
        </header>

        <div class="article_content">
            <p>Vamos a seguir con nuestra serie sobre <a href="https://pybonacci.org/tag/python-fuente-de-sabiduria/">'<strong>p</strong>ython, <strong>f</strong>uente de <strong>s</strong>abiduria'</a> hablando sobre la multiplicación.</p>
<p>¿Te has preguntado alguna vez cómo se multiplican dos números en un ordenador o calculadora? Normalmente, los <a href="http://en.wikipedia.org/wiki/Arithmetic_logic_unit" target="_blank">circuitos</a> de los procesadores incluyen operaciones básicas como la <a href="http://en.wikipedia.org/wiki/Multiplication_algorithm#Shift_and_add" target="_blank">multiplicación de enteros de tamaño pequeño</a>. Sobre estas operaciones básicas se construye todo lo demás.</p>
<p>El caso que nos ocupa hoy, multiplicar números enteros muy grandes, se consigue mediante el uso de algoritmos vía software. Una forma sencilla de calcular enteros es usando la misma metodología que usábamos en la escuela, con la tabla de multiplicar del uno al diez y con sumas:</p>
<div class="highlight"><pre><span></span>    23958233
        5830 ×
------------
    00000000 ( =      23,958,233 ×     0)
   71874699  ( =      23,958,233 ×    30)
 191665864   ( =      23,958,233 ×   800)
119791165    ( =      23,958,233 × 5,000)
------------
139676498390 ( = 139,676,498,390        )
</pre></div>


<p>(ejemplo extraído de <a href="http://en.wikipedia.org/wiki/Multiplication_algorithm#Example" target="_blank">wikipedia</a>)</p>
<p>El algoritmo que hace uso de esa metodología se suele llamar <code>long</code>, <code>grade-school</code>, <code>naïve</code>,..., multiplication. En este caso vamos a hacer una implementación <em>sucia</em> de este algoritmo descomponiendo el 'multiplicador' en dígitos que multiplicaremos al 'multiplicando':</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">naive</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">yyy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">yy</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">yyy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>


<p>Para el ejemplo anterior (multiplicando = 23958233 y multiplicador = 5830) lo que estariamos haciendo sería lo siguiente:</p>
<ul>
<li>el multiplicador lo descomponemos en una lista de los dígitos que lo componen, [5, 8, 3, 0]</li>
<li>el 0 lo multiplicamos por el multiplicando</li>
<li>el 3 lo multiplicamos por 10 y por el multiplicando y lo sumamos al resultado del paso anterior</li>
<li>el 8 lo multiplicamos por 100 y por el multiplicando y lo sumamos al resultado del paso anterior</li>
<li>el 5 lo multiplicamos por 1000 y por el multiplicando y lo sumamos al resultado del paso anterior</li>
<li>devolvemos el resultado final</li>
</ul>
<p>Esta es una forma de hacer multiplicaciones pero cuando los números involucrados en la multiplicación son muy grandes podemos encontrarnos con problemas de rendimiento y perder mucho tiempo haciendo un cálculo.</p>
<p>Como en el desarrollo de Python hay gente muy inteligente, si buceas por el <a href="http://hg.python.org/cpython/file/tip/Objects/longobject.c" target="_blank">código fuente de Python</a> verás que para multiplicación de <code>long</code>'s se usa el algoritmo de la multiplicación rápida de Karatsuba. ¿Y quién demonios es este japonés? Pues este japonés <a href="http://en.wikipedia.org/wiki/Karatsuba_algorithm" target="_blank">es un ruso al que, con 23 añitos (en 1960), se le ocurrió llevar la contraria al mismísimo Kolmogorov</a>.</p>
<p>Lo mejor es que le echéis un ojo a la siguiente <a href="http://www.stoimen.com/blog/2012/05/15/computer-algorithms-karatsuba-fast-multiplication/" target="_blank">entrada</a> (o en la <a href="http://es.wikipedia.org/wiki/Algoritmo_de_Karatsuba" target="_blank">Wikipedia en español</a>) para entender más claramente el funcionamiento (<a href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank">DRY</a>). Básicamente, de lo que se trata es de minimizar el número de multiplicaciones (aunque no siempre se consigue) usando una estrategia de 'divide y vencerás'.</p>
<p>A continuación os dejo una implementación muy compacta que he encontrado en <a href="http://nayuki.eigenstate.org/page/karatsuba-multiplication" target="_blank">project nayuki</a> (si no entendéis algo del código preguntad en los comentarios):</p>
<div class="highlight"><pre><span></span><span class="c1"># http://nayuki.eigenstate.org/res/karatsuba-multiplication/karatsuba.py</span>
<span class="c1"># http://nayuki.eigenstate.org/page/karatsuba-multiplication</span>
<span class="n">_CUTOFF</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="k">def</span> <span class="nf">kara</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">_CUTOFF</span> <span class="ow">or</span> <span class="n">y</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">_CUTOFF</span><span class="p">:</span>  <span class="c1"># Base case</span>
        <span class="c1">#print(&#39;naive&#39;)</span>
        <span class="k">return</span> <span class="n">naive</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&#39;karatsuba&#39;)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">bit_length</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">bit_length</span><span class="p">())</span>
        <span class="n">half</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="o">//</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">32</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">half</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">xlow</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">mask</span>
        <span class="n">ylow</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="n">mask</span>
        <span class="n">xhigh</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">half</span>
        <span class="n">yhigh</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">half</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">kara</span><span class="p">(</span><span class="n">xhigh</span><span class="p">,</span> <span class="n">yhigh</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">kara</span><span class="p">(</span><span class="n">xlow</span> <span class="o">+</span> <span class="n">xhigh</span><span class="p">,</span> <span class="n">ylow</span> <span class="o">+</span> <span class="n">yhigh</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">kara</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span> <span class="n">ylow</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="n">c</span>
        <span class="k">return</span> <span class="p">(((</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">half</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">half</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>


<p>Bien, pues vamos a ver si esto es capar de optimizar mi función <code>naive</code>. Para ello vamos a multiplicar el siguiente número (tened cuidado si vuestro ordenador no es muy potente ya que el cálculo se puede llegar a alargar):</p>
<div class="highlight"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="mi">1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">14000</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="mi">1234567890123456789012345678901234567890123456789012345678901234567890</span>
<span class="mi">1234567890123456789012345678900000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">0000000000000000000000000000000000000000000000000000000000000000000000</span>
<span class="mo">000000000000000000000000000000</span>
</pre></div>


<p>( Qué post más largo... 🙂 )</p>
<p>Usando la función <code>naive</code>.</p>
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">naive</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">naive</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</pre></div>


<p><code>1 loops, best of 3: 1.31 s per loop</code></p>
<p>Usando la función <code>kara</code></p>
<div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">kara</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">kara</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</pre></div>


<p><code>10 loops, best of 3: 172 ms per loop</code></p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="mf">1.31</span> <span class="o">/</span> <span class="mf">0.173</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="bp">True</span>
<span class="mf">7.572254335260117</span>
</pre></div>


<p>Vemos que hemos conseguido una ganancia de 7.5x!!!</p>
<p>Aunque si comprobamos como lo hace Python vemos que no hemos hecho una gran optimización (aunque no era lo importante de esta entrada):</p>
<div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">num</span> <span class="o">*</span> <span class="n">num</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</pre></div>


<p><code>1000 loops, best of 3: 455 µs per loop</code></p>
<p>Parece que solo es alrededor de 375 veces más rápido 😉</p>
<p>Este código lo he probado en Python 3.3, si veis alguna errata o alguna barbaridad que haya podido decir, por favor, avísadme.</p>
<p>Esta entrada la puedes descargar en formato notebook desde <a href="https://github.com/Pybonacci/notebooks" target="_blank">nuestro repositorio en github</a>.</p>
<p>P.D.: Pretendía que esta entrada fuera más rigurosa y completa pero mi tiempo se ha visto disminuido de forma drástica últimamente. La familia manda 🙂</p>
        </div>

        <div class="meta">
            <div class="tags">
                    <a href="http://pybonacci.github.io/tag/exponenciacion-binaria.html" class="tag">exponenciación binaria</a>
                    <a href="http://pybonacci.github.io/tag/optimizacion.html" class="tag">optimización</a>
                    <a href="http://pybonacci.github.io/tag/pfs.html" class="tag">PFS</a>
                    <a href="http://pybonacci.github.io/tag/potencias.html" class="tag">potencias</a>
                    <a href="http://pybonacci.github.io/tag/python.html" class="tag">python</a>
                    <a href="http://pybonacci.github.io/tag/python-fuente-de-sabiduria.html" class="tag">Python fuente de sabiduria</a>
            </div>
        </div>

  
<hr>    
<div class="row">
  <div class="col-md-2">
    <img src=https://pybonacci.org/images/author/kiko-correoso.jpg alt="photo" class="img-author img-rounded"/>
  </div>
  <div class="col-md-1"></div>
  <div class="col-md-9 description-author">
    <p>Kiko es doctor en ciencias físicas y esta especializado en física de la atmósfera, meteorología y climatología. Además de estar en las nubes es especialista en temas de energías renovables en Iberdrola. Ávido de seguir mejorando siempre está abierto a participar en nuevos proyectos y retos por lo que no dudes en contactarle si necesitas servicios especializados de Python o meteorología.
</p>
  </div>
</div> 

    </article>
<section id="isso-thread">
    <h3>Comentarios</h3>
</section>
</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>

        <footer class="disclaimer">
          <div class="container-fluid">
            <p>
              © 2012-2018 Pybonacci, licencia <a href="https://github.com/Pybonacci/pybonacci.github.io/blob/sources/LICENSE.md"> CC BY-SA 4.0 + MIT</a>
              salvo otra indicación.
              <p>Contenido generado con <a href= "http://docs.getpelican.com/">Pelican</a>.</p>
            </p>
          </div>
        </footer>

    </body>
</html>