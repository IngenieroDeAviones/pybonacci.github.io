<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Pybonacci">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Joyitas en la stdlib: collections | Pybonacci</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Pybonacci blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/fontello.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>.description-author {
  font-size: 0.8em;
  color: #333;
}
.img-author {
  max-height: 10em;
  max-width: 10em;
}
img[src$="centerme"] {
  display: block;
  margin: 0 auto;
}
body {
  margin: 0;
  padding: 0;
  font: 'Source Sans Pro', sans-serif;
  color: #222222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
@media all and (min-width: 960px) {
  body {
    font-size: 20px;
  }
}
@media all and (max-width: 959px) and (min-width: 600px) {
  body {
    font-size: 16px;
  }
}
@media all and (max-width: 599px) and (min-width: 320px) {
  body {
    font-size: 14px;
  }
}
div.input_area {
  font-size: 1.1em;
  margin: 0 10%;
}
div.output_area {
  font-size: 1.1em;
  margin: 0 10%;
}
div.output_subarea {
  max-width: 100% !important;
}
pre {
  font-size: 1.1em;
}
p {
  margin-bottom: 20px;
  line-height: 1.6em;
  text-align: justify;
}
img {
  display: block;
  margin-left: auto;
  margin-right: auto;
  max-width: 100%;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article .meta {
  margin-top: 35px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta address:before,
article .meta time:before,
article .meta a.tag:before {
  font-family: 'fontello';
  margin-right: 6px;
}
article .meta address.author {
  float: left;
}
article .meta address:before {
  content: '\e819';
}
article .meta time:before {
  content: '\f133';
}
article .meta div.tags {
  clear: both;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:before {
  content: '\e821';
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 1.5em;
  font-weight: 800;
  padding: 10px 20px;
  color: #007aa3;
  background: #FFF;
  border: 1px solid #007aa3;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #007aa3;
}
article .meta:after {
  content: "";
  display: table;
  clear: both;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script data-isso="https://comments.pybonacci.org"
                data-isso-lang="es"
                src="https://comments.pybonacci.org/js/embed.min.js"></script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        });
        MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>


        </script>

    </head>

    <body>
        <header class="navbar navbar-default bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Pybonacci</a><!-- — Python y Ciencia-->
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/acerca-de-pybonacci.html" title="About">Acerca de</a></li>
			    <li><a href="/pages/como-contribuir.html" title="Contributing">Contribuir</a></li>
                            <li><a href="/archives.html" title="Archive">Archivos</a></li>
                            <li><a class="nodec icon-rss" href="/feeds/all.atom.xml" title="pybonacci.github.io RSS feed" rel="me"></a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Joyitas en la stdlib: collections</h1>
            <div class="meta">
                <time datetime="article.date.isoformat()" pubdate>dom 08 mayo 2016</time>
                <address class="vcard author">Por
                    <a class="url fn" href="http://pybonacci.github.io/author/kiko-correoso.html">Kiko Correoso</a>
                </address>
            </div>
        </header>

        <div class="article_content">
            <p>Dentro de la biblioteca estándar de Python dispones de auténticas joyas, muchas veces ignoradas u olvidadas. Es por ello que voy a empezar un breve pero intenso recorrido por algunas piezas de arte disponibles de serie.</p>
<h1>Módulo <code>collections</code></h1>
<p>Con la ayuda de este módulo puedes aumentar las estructuras de datos típicas disponibles en Python (listas, tuplas, diccionarios,...).</p>
<p>Veamos algunas utilidades disponibles:</p>
<h1><code>ChainMap</code></h1>
<p><strong>Solo Python 3. Actualízate!!</strong></p>
<p>Dicho en bruto, es un conglomerado de diccionarios (también conocidos como <em>mappings</em> o <em>hash tables</em>).</p>
<p>Para que puede ser útil:</p>
<ul>
<li><a href="https://docs.python.org/3/library/collections.html#chainmap-examples-and-recipes">Ejemplos en la documentación de Python</a>.</li>
<li>Actualizar partes de una configuración.</li>
<li>Actualizar un diccionario pero que pueda ser de forma reversible.</li>
<li><a href="https://github.com/search?l=python&amp;q=from+collections+import+Chainmap&amp;ref=searchresults&amp;type=Code&amp;utf8=%E2%9C%93">Ejemplos de uso en github</a>.</li>
<li>...</li>
</ul>
<p>Ejemplo, imaginemos que tenemos un diccionario de configuración <code>dict_a</code>, que posee las claves <code>a</code> y <code>b</code>, y queremos actualizar sus valores con otros pares <em>clave:valor</em> que están en el diccionario <code>dict_b</code>, que posee las claves <code>b</code> y <code>c</code>. Podemos hacer:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">ChainMap</span>

<span class="n">dict_a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="n">dict_b</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">}</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">(</span><span class="n">dict_a</span><span class="p">,</span> <span class="n">dict_b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>a 1
c 1000
b 10
</pre></div>


<p>Hemos añadido el valor de la clave <code>c</code> de <code>dict_b</code> sin necesidad de modificar nuestro diccionario original de configuración <code>dict_a</code>, es decir, hemos hecho un 'cambio' reversible. También podemos 'sobreescribir' las claves que están en nuestro diccionario original de configuración, <code>dict_b</code> variando los parámetros del constructor:</p>
<div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">ChainMap</span><span class="p">(</span><span class="n">dict_b</span><span class="p">,</span> <span class="n">dict_a</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cm</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>b 100
a 1
c 1000
</pre></div>


<p>Vemos que, además de añadir la clave <code>c</code>, hemos sobreescrito la clave <code>b</code>.</p>
<p>Los diccionarios originales están disponibles haciendo uso del atributo <code>maps</code>:</p>
<p><code>cm.maps</code></p>
<p><strong>OUTPUT:</strong></p>
<p><code>[{'b': 100, 'c': 1000}, {'a': 1, 'b': 10}]</code></p>
<p>Ejercicio: haced un <code>dir</code> de <code>cm</code> y un <code>dir</code> de <code>dict_a</code> y veréis que los atributos y métodos disponibles son parecidos.</p>
<p>Más información en <a href="https://stackoverflow.com/questions/23392976/what-is-the-purpose-of-collections-chainmap">este hilo de stackoverflow</a> en el que me he basado para el ejemplo anterior (¿basar y copiar no son sinónimos?).</p>
<h1><code>Counter</code></h1>
<p>Permite contar ocurrencias de forma simple. En realidad, su funcionalidad se podría conseguir sin problemas con algunas líneas extra de código pero ya que lo tenemos, está testeado e implementado por gente experta vamos a aprovecharnos de ello.</p>
<p>En la documentación oficial hay <a href="https://docs.python.org/3/library/collections.html#counter-objects">algunos ejemplos interesantes</a> y en github podéis encontrar <a href="https://github.com/search?l=python&amp;q=from+collections+import+Counter&amp;ref=searchresults&amp;type=Code&amp;utf8=%E2%9C%93">unos cuantos más</a>. Veamos un ejemplo simple pero potente, yo trabajo mucho con datos meteorológicos y uno de los problemas recurrentes es tener fechas repetidas que no deberían existir (pero pasa demasiado a menudo). Una forma rápida de buscar problemas de estos en ficheros y lanzar una alarma cuando ocurra lo que buscamos, sería:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">virtual_file</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;2010/01/01 2.7</span>
<span class="s2">2010/01/02 2.2</span>
<span class="s2">2010/01/03 2.1</span>
<span class="s2">2010/01/04 2.3</span>
<span class="s2">2010/01/05 2.4</span>
<span class="s2">2010/01/06 2.2</span>
<span class="s2">2010/01/02 2.2</span>
<span class="s2">2010/01/03 2.1</span>
<span class="s2">2010/01/04 2.3</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">Counter</span><span class="p">(</span><span class="n">virtual_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;fichero con fecha repetida&#39;</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<p><code>fichero con fecha repetida</code></p>
<h1><code>namedtuple</code></h1>
<p>A veces me toca crear algún tipo de estructura que guarda datos y algunos metadatos. Una forma simple sin crear una clase ad-hoc sería usar un diccionario. Un ejemplo simple sería:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">dt</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">datos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;valores&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;frecuencia&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s1">&#39;fecha_inicial&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">,</span> <span class="p">),</span>
    <span class="s1">&#39;parametro&#39;</span><span class="p">:</span> <span class="s1">&#39;wind_speed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;unidades&#39;</span><span class="p">:</span> <span class="s1">&#39;m/s&#39;</span>
<span class="p">}</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>{&#39;fecha_inicial&#39;: datetime.datetime(2016, 1, 1, 0, 0),
 &#39;frecuencia&#39;: datetime.timedelta(0, 600),
 &#39;parametro&#39;: &#39;wind_speed&#39;,
 &#39;unidades&#39;: &#39;m/s&#39;,
 &#39;valores&#39;: array([-3.02664796, -0.59492715, -1.36233816, -0.27333458,  0.34971592,
        1.43105631,  1.12980511,  0.49542105,  0.37546829,  1.37230197,
       -1.00757915,  1.39334713,  0.73904326,  0.01129817,  0.12431242,
        0.4388826 , -0.49561972, -0.9777947 ,  0.6009799 ,  0.89101799,
        0.48529884,  1.80287157,  1.56321415, -0.62089358, -2.22113341,
       -0.04751354,  0.89715794, -0.23252567,  0.2259216 ,  0.35214745,
       -1.50915239, -1.46547279, -0.4260315 ,  0.20851012,  1.60555432,
        0.4221521 , -1.03399518,  1.68276277,  0.5010984 ,  0.01294853,
       -0.80004557,  1.72141514, -1.38314354,  0.41374512,  0.32861028,
       -2.22385654,  0.80125671, -0.84757451,  0.66896035, -0.26901047,
       -0.06195842, -0.60743183, -0.15538184,  1.16314508, -0.42198419,
        0.61174838,  0.97211057, -1.19791368, -0.68773007,  2.96956504,
       -1.13000346, -0.24523032,  1.6312053 ,  0.77060561, -1.69925633,
       -0.31417013,  0.44196826, -0.59763569,  0.91595894,  1.47587324,
        0.5520219 , -0.62321715,  0.32543574, -1.26181508,  0.94623275,
       -0.25690824,  1.36108942,  0.15445091, -1.25607974,  0.50635589,
        0.65698443, -0.82418166, -0.34054522,  0.23511397, -1.5096761 ,
       -1.12291338, -1.82440698, -0.47433931, -1.86537903,  1.29256869,
        1.78898905,  0.72081117, -0.15169929, -1.24106944,  0.68920997,
        0.36932816, -1.15901835, -0.93990956,  0.37258685, -0.41316085])}
</pre></div>


<p>Lo anterior es simple y rápido pero usando una <code>namedtuple</code> dispongo de algo parecido con algunas cosas extra. Veamos un ejemplo similar usando <code>namedtuple</code>:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Datos</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Datos&#39;</span><span class="p">,</span> <span class="s1">&#39;valores frecuencia fecha_inicial parametro unidades&#39;</span><span class="p">)</span>

<span class="n">datos</span> <span class="o">=</span> <span class="n">Datos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> 
              <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">),</span>
              <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">,</span> <span class="p">),</span>
              <span class="s1">&#39;wind_speed&#39;</span><span class="p">,</span>
              <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>Datos(valores=array([ 1.50377059, -1.48083897, -0.76143985,  0.15346996, -0.01094251,
        0.42117233,  1.07136364, -0.24586714,  1.2001748 ,  0.56880926,
        0.56959121,  0.63811853,  0.4621489 ,  1.06636058,  0.32129287,
        2.42264145, -1.25830559, -0.27102862,  2.04853711,  2.07166845,
       -0.27138347, -0.07075163, -0.43547714,  1.69140984,  2.57150371,
        0.80336641, -0.78767876, -2.22281324,  0.23112338, -0.0605485 ,
        0.58304378,  3.33116997, -1.1285789 , -0.2047658 , -0.39240644,
       -1.69724959, -0.0313781 , -0.22892613, -0.06029154, -0.32368036,
       -0.12969429,  1.06231438,  0.05429922, -1.12206555,  1.33383161,
        0.92582424,  0.51615352,  0.93188459,  0.65273332,  0.39108396,
        1.56345696, -0.33158622, -0.27455745,  0.69101563,  1.61244861,
        0.7961402 ,  0.38661924, -0.99864208, -0.10720116,  0.40919342,
       -0.43784138, -3.06455306,  1.69280852,  1.82180641,  0.03604298,
        0.17515747,  1.4370723 , -0.47437528,  1.14510249,  1.36360776,
        0.34575948, -0.14623582,  1.1048332 , -0.2266261 ,  1.34319382,
        0.75608216, -0.62416011, -0.27821722,  0.45365802, -0.98537653,
        0.20172051,  1.70476797,  0.55529542, -0.07833625, -0.62619796,
       -0.02892921, -0.07349236,  0.94659497,  0.20823509,  0.91628769,
       -1.14603843, -0.20748714,  1.13008222, -0.93365802, -0.48125316,
        0.45564591, -0.03136778, -0.86333962,  1.04590165, -0.51757806]), frecuencia=datetime.timedelta(0, 600), fecha_inicial=datetime.datetime(2016, 1, 1, 0, 0), parametro=&#39;wind_speed&#39;, unidades=&#39;m/s&#39;)
</pre></div>


<p>Ventajas que le veo con respecto a lo anterior:</p>
<ul>
<li>Puedo acceder a los 'campos' o claves del diccionario usando <em>dot notation</em></li>
</ul>
<p><code>print(datos.valores)</code></p>
<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>[ 1.50377059 -1.48083897 -0.76143985  0.15346996 -0.01094251  0.42117233
  1.07136364 -0.24586714  1.2001748   0.56880926  0.56959121  0.63811853
  0.4621489   1.06636058  0.32129287  2.42264145 -1.25830559 -0.27102862
  2.04853711  2.07166845 -0.27138347 -0.07075163 -0.43547714  1.69140984
  2.57150371  0.80336641 -0.78767876 -2.22281324  0.23112338 -0.0605485
  0.58304378  3.33116997 -1.1285789  -0.2047658  -0.39240644 -1.69724959
 -0.0313781  -0.22892613 -0.06029154 -0.32368036 -0.12969429  1.06231438
  0.05429922 -1.12206555  1.33383161  0.92582424  0.51615352  0.93188459
  0.65273332  0.39108396  1.56345696 -0.33158622 -0.27455745  0.69101563
  1.61244861  0.7961402   0.38661924 -0.99864208 -0.10720116  0.40919342
 -0.43784138 -3.06455306  1.69280852  1.82180641  0.03604298  0.17515747
  1.4370723  -0.47437528  1.14510249  1.36360776  0.34575948 -0.14623582
  1.1048332  -0.2266261   1.34319382  0.75608216 -0.62416011 -0.27821722
  0.45365802 -0.98537653  0.20172051  1.70476797  0.55529542 -0.07833625
 -0.62619796 -0.02892921 -0.07349236  0.94659497  0.20823509  0.91628769
 -1.14603843 -0.20748714  1.13008222 -0.93365802 -0.48125316  0.45564591
 -0.03136778 -0.86333962  1.04590165 -0.51757806]
</pre></div>


<ul>
<li>Puedo ver el código usado para crear la estructura de datos usando <code>verbose = True</code>. Usa <code>exec</code> <a href="https://hg.python.org/cpython/file/3.5/Lib/collections/__init__.py#l301">entre bambalinas</a> (o_O). Puedo ver que todas las claves se transforman en <code>property</code>'s. Puedo ver que se crea documentación... MAGIA en estado puro!!!</li>
</ul>
<p><em>(Si no quieres usar la keyword <code>verbose = True</code> puedes seguir teniendo acceso en un objeto usando <code>obj._source</code>)</em></p>
<div class="highlight"><pre><span></span><span class="n">Datos</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Datos&#39;</span><span class="p">,</span> <span class="s1">&#39;valores frecuencia fecha_inicial parametro unidades&#39;</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">property</span> <span class="k">as</span> <span class="n">_property</span><span class="p">,</span> <span class="nb">tuple</span> <span class="k">as</span> <span class="n">_tuple</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span> <span class="k">as</span> <span class="n">_itemgetter</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="k">class</span> <span class="nc">Datos</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
    <span class="s1">&#39;Datos(valores, frecuencia, fecha_inicial, parametro, unidades)&#39;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;valores&#39;</span><span class="p">,</span> <span class="s1">&#39;frecuencia&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_inicial&#39;</span><span class="p">,</span> <span class="s1">&#39;parametro&#39;</span><span class="p">,</span> <span class="s1">&#39;unidades&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">valores</span><span class="p">,</span> <span class="n">frecuencia</span><span class="p">,</span> <span class="n">fecha_inicial</span><span class="p">,</span> <span class="n">parametro</span><span class="p">,</span> <span class="n">unidades</span><span class="p">):</span>
        <span class="s1">&#39;Create new instance of Datos(valores, frecuencia, fecha_inicial, parametro, unidades)&#39;</span>
        <span class="k">return</span> <span class="n">_tuple</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="p">(</span><span class="n">valores</span><span class="p">,</span> <span class="n">frecuencia</span><span class="p">,</span> <span class="n">fecha_inicial</span><span class="p">,</span> <span class="n">parametro</span><span class="p">,</span> <span class="n">unidades</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_make</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="nb">tuple</span><span class="o">.</span><span class="fm">__new__</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">):</span>
        <span class="s1">&#39;Make a new Datos object from a sequence or iterable&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">iterable</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected 5 arguments, got </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_replace</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="s1">&#39;Return a new Datos object replacing specified fields with new values&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_self</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;valores&#39;</span><span class="p">,</span> <span class="s1">&#39;frecuencia&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_inicial&#39;</span><span class="p">,</span> <span class="s1">&#39;parametro&#39;</span><span class="p">,</span> <span class="s1">&#39;unidades&#39;</span><span class="p">),</span> <span class="n">_self</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">kwds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Got unexpected field names: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwds</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;(valores=</span><span class="si">%r</span><span class="s1">, frecuencia=</span><span class="si">%r</span><span class="s1">, fecha_inicial=</span><span class="si">%r</span><span class="s1">, parametro=</span><span class="si">%r</span><span class="s1">, unidades=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return a new OrderedDict which maps field names to their values.&#39;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">valores</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 0&#39;</span><span class="p">)</span>

    <span class="n">frecuencia</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 1&#39;</span><span class="p">)</span>

    <span class="n">fecha_inicial</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 2&#39;</span><span class="p">)</span>

    <span class="n">parametro</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 3&#39;</span><span class="p">)</span>

    <span class="n">unidades</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 4&#39;</span><span class="p">)</span>

<span class="c1"># Lo mismo de antes</span>
<span class="k">print</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">_source</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">property</span> <span class="k">as</span> <span class="n">_property</span><span class="p">,</span> <span class="nb">tuple</span> <span class="k">as</span> <span class="n">_tuple</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span> <span class="k">as</span> <span class="n">_itemgetter</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="k">class</span> <span class="nc">Datos</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
    <span class="s1">&#39;Datos(valores, frecuencia, fecha_inicial, parametro, unidades)&#39;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;valores&#39;</span><span class="p">,</span> <span class="s1">&#39;frecuencia&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_inicial&#39;</span><span class="p">,</span> <span class="s1">&#39;parametro&#39;</span><span class="p">,</span> <span class="s1">&#39;unidades&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">valores</span><span class="p">,</span> <span class="n">frecuencia</span><span class="p">,</span> <span class="n">fecha_inicial</span><span class="p">,</span> <span class="n">parametro</span><span class="p">,</span> <span class="n">unidades</span><span class="p">):</span>
        <span class="s1">&#39;Create new instance of Datos(valores, frecuencia, fecha_inicial, parametro, unidades)&#39;</span>
        <span class="k">return</span> <span class="n">_tuple</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="p">(</span><span class="n">valores</span><span class="p">,</span> <span class="n">frecuencia</span><span class="p">,</span> <span class="n">fecha_inicial</span><span class="p">,</span> <span class="n">parametro</span><span class="p">,</span> <span class="n">unidades</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_make</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="nb">tuple</span><span class="o">.</span><span class="fm">__new__</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">):</span>
        <span class="s1">&#39;Make a new Datos object from a sequence or iterable&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">iterable</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected 5 arguments, got </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_replace</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="s1">&#39;Return a new Datos object replacing specified fields with new values&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_self</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;valores&#39;</span><span class="p">,</span> <span class="s1">&#39;frecuencia&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha_inicial&#39;</span><span class="p">,</span> <span class="s1">&#39;parametro&#39;</span><span class="p">,</span> <span class="s1">&#39;unidades&#39;</span><span class="p">),</span> <span class="n">_self</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">kwds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Got unexpected field names: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwds</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;(valores=</span><span class="si">%r</span><span class="s1">, frecuencia=</span><span class="si">%r</span><span class="s1">, fecha_inicial=</span><span class="si">%r</span><span class="s1">, parametro=</span><span class="si">%r</span><span class="s1">, unidades=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return a new OrderedDict which maps field names to their values.&#39;</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">valores</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 0&#39;</span><span class="p">)</span>

    <span class="n">frecuencia</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 1&#39;</span><span class="p">)</span>

    <span class="n">fecha_inicial</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 2&#39;</span><span class="p">)</span>

    <span class="n">parametro</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 3&#39;</span><span class="p">)</span>

    <span class="n">unidades</span> <span class="o">=</span> <span class="n">_property</span><span class="p">(</span><span class="n">_itemgetter</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Alias for field number 4&#39;</span><span class="p">)</span>
</pre></div>


<ul>
<li>Puedo seguir obteniendo un diccionario (un <code>OrderedDict</code>, también incluido en el módulo <code>collections</code>) si así lo deseo:</li>
</ul>
<p><code>datos._asdict()['valores']</code></p>
<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>array([ 1.50377059, -1.48083897, -0.76143985,  0.15346996, -0.01094251,
        0.42117233,  1.07136364, -0.24586714,  1.2001748 ,  0.56880926,
        0.56959121,  0.63811853,  0.4621489 ,  1.06636058,  0.32129287,
        2.42264145, -1.25830559, -0.27102862,  2.04853711,  2.07166845,
       -0.27138347, -0.07075163, -0.43547714,  1.69140984,  2.57150371,
        0.80336641, -0.78767876, -2.22281324,  0.23112338, -0.0605485 ,
        0.58304378,  3.33116997, -1.1285789 , -0.2047658 , -0.39240644,
       -1.69724959, -0.0313781 , -0.22892613, -0.06029154, -0.32368036,
       -0.12969429,  1.06231438,  0.05429922, -1.12206555,  1.33383161,
        0.92582424,  0.51615352,  0.93188459,  0.65273332,  0.39108396,
        1.56345696, -0.33158622, -0.27455745,  0.69101563,  1.61244861,
        0.7961402 ,  0.38661924, -0.99864208, -0.10720116,  0.40919342,
       -0.43784138, -3.06455306,  1.69280852,  1.82180641,  0.03604298,
        0.17515747,  1.4370723 , -0.47437528,  1.14510249,  1.36360776,
        0.34575948, -0.14623582,  1.1048332 , -0.2266261 ,  1.34319382,
        0.75608216, -0.62416011, -0.27821722,  0.45365802, -0.98537653,
        0.20172051,  1.70476797,  0.55529542, -0.07833625, -0.62619796,
       -0.02892921, -0.07349236,  0.94659497,  0.20823509,  0.91628769,
       -1.14603843, -0.20748714,  1.13008222, -0.93365802, -0.48125316,
        0.45564591, -0.03136778, -0.86333962,  1.04590165, -0.51757806])
</pre></div>


<ul>
<li>
<p>Puedo crear subclases de forma simple para añadir funcionalidad. Por ejemplo, creamos una nueva clase con un nuevo método que calcula la media de los <code>valores</code>:</p>
<p>:::python
class DatosExtendidos(Datos):
    def media(self):
        "Calcula la media de los valores."
        return self.valores.mean()</p>
<p>datos_ext = DatosExtendidos(**datos._asdict())</p>
<p>print(datos_ext.media())</p>
</li>
</ul>
<p><code>0.27764229179</code></p>
<p><strong>WOW!!!!!</strong></p>
<p>Los ejemplos en la <a href="https://docs.python.org/3/library/collections.html?highlight=collections#collections.namedtuple">documentación oficial son muy potentes y dan nuevas ideas de potenciales usos</a>.</p>
<h1><code>deque</code></h1>
<p>Otra joyita que quizá debería usar más a menudo sería <code>deque</code>. Es una secuencia mutable (parecido a una lista), pero con una serie de ventajas. Es una <a href="https://es.wikipedia.org/wiki/Cola_%28inform%C3%A1tica%29">cola/lista</a> cuyo principio y fin es 'indistinguible', es <em>thread-safe</em> y está diseñada para poder insertar y eliminar de forma rápida en ambos extremos de la cola (ahora veremos qué significa todo esto). Un uso evidente es el de usar, por ejemplo, una secuencia como <em>stream</em> de datos con un número de elementos fijo y/o rápidamente actualizable:</p>
<ul>
<li>Podemos limitar su tamaño y si añadimos elementos por un lado se eliminan los del otro extremo.</li>
<li>Podemos rotar los datos de forma eficiente.</li>
<li>...</li>
</ul>
<p>Veamos un ejemplo:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">dq</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">maxlen</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">dq</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>deque([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div>


<hr>
<div class="highlight"><pre><span></span><span class="c1"># los tres últimos elementos los anexa nuevamente al principio de la secuencia.</span>
<span class="n">dq</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dq</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">+</span> <span class="n">lst</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>deque([7, 8, 9, 0, 1, 2, 3, 4, 5, 6], maxlen=10)
[7, 8, 9, 0, 1, 2, 3, 4, 5, 6]
</pre></div>


<p>Veamos la eficiencia de esta operación:</p>
<div class="highlight"><pre><span></span><span class="s s-Atom">tmp</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span> <span class="s s-Atom">maxlen</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">)</span>
<span class="c1">%timeit dq.rotate(30000)</span>
<span class="s s-Atom">tmp</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span>
<span class="c1">%timeit tmp[-30000:] + tmp[:-30000]</span>

<span class="nv">The</span> <span class="s s-Atom">slowest</span> <span class="s s-Atom">run</span> <span class="s s-Atom">took</span> <span class="mf">9.62</span> <span class="s s-Atom">times</span> <span class="s s-Atom">longer</span> <span class="s s-Atom">than</span> <span class="s s-Atom">the</span> <span class="s s-Atom">fastest</span><span class="p">.</span> <span class="nv">This</span> <span class="s s-Atom">could</span> <span class="s s-Atom">mean</span> <span class="s s-Atom">that</span> <span class="s s-Atom">an</span> <span class="s s-Atom">intermediate</span> <span class="s s-Atom">result</span> <span class="o">is</span> <span class="s s-Atom">being</span> <span class="s s-Atom">cached</span><span class="p">.</span>
<span class="mi">1000000</span> <span class="s s-Atom">loops</span><span class="p">,</span> <span class="s s-Atom">best</span> <span class="s s-Atom">of</span> <span class="mi">3</span><span class="s s-Atom">:</span> <span class="mi">519</span> <span class="s s-Atom">ns</span> <span class="s s-Atom">per</span> <span class="s s-Atom">loop</span>
<span class="mi">100</span> <span class="s s-Atom">loops</span><span class="p">,</span> <span class="s s-Atom">best</span> <span class="s s-Atom">of</span> <span class="mi">3</span><span class="s s-Atom">:</span> <span class="mf">3.07</span> <span class="s s-Atom">ms</span> <span class="s s-Atom">per</span> <span class="s s-Atom">loop</span>
</pre></div>


<p>Con una <code>queue</code> podemos anexar de forma eficiente a ambos lados:</p>
<div class="highlight"><pre><span></span>dq.append(100)
print(dq)
dq.appendleft(10000)
print(dq)
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>deque([8, 9, 0, 1, 2, 3, 4, 5, 6, 100], maxlen=10)
deque([10000, 8, 9, 0, 1, 2, 3, 4, 5, 6], maxlen=10)
</pre></div>


<hr>
<div class="highlight"><pre><span></span>dq.extend(range(10))
print(dq)
dq.extendleft([10, 100])
print(dq)
</pre></div>


<p><strong>OUTPUT:</strong></p>
<div class="highlight"><pre><span></span>deque([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)
deque([100, 10, 0, 1, 2, 3, 4, 5, 6, 7], maxlen=10)
</pre></div>


<p>Etc.</p>
<p>Puedes hacer cosas similares a las hechas con listas pero de forma más eficiente y práctica en determinados casos!!</p>
<p>Recordad que, además, disponemos del <a href="https://docs.python.org/3/library/queue.html">módulo <code>queue</code> en la librería estándar</a>.</p>
<h1>Conclusión</h1>
<p>Este módulo esconde cosas muy interesantes, algunas que no hemos visto. Por tanto, si no lo conocéis, deberíais explorar el módulo <code>collections</code>, si lo conocéis nos podéis indicar como lo usáis en los comentarios que puedes encontrar más abajo.</p>
        </div>

        <div class="meta">
            <div class="tags">
                    <a href="http://pybonacci.github.io/tag/collections.html" class="tag">collections</a>
                    <a href="http://pybonacci.github.io/tag/contenedores.html" class="tag">contenedores</a>
                    <a href="http://pybonacci.github.io/tag/secuencias.html" class="tag">secuencias</a>
                    <a href="http://pybonacci.github.io/tag/stdlib.html" class="tag">stdlib</a>
            </div>
        </div>

  
<hr>    
<div class="row">
  <div class="col-md-2">
    <img src=https://pybonacci.org/images/author/kiko-correoso.jpg alt="photo" class="img-author img-rounded"/>
  </div>
  <div class="col-md-1"></div>
  <div class="col-md-9 description-author">
    <p>Kiko es doctor en ciencias físicas y esta especializado en física de la atmósfera, meteorología y climatología. Además de estar en las nubes es especialista en temas de energías renovables en Iberdrola. Ávido de seguir mejorando siempre está abierto a participar en nuevos proyectos y retos por lo que no dudes en contactarle si necesitas servicios especializados de Python o meteorología.
</p>
  </div>
</div> 

    </article>
<section id="isso-thread">
    <h3>Comentarios</h3>
</section>
</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>

        <footer class="disclaimer">
          <div class="container-fluid">
            <p>
              © 2012-2018 Pybonacci, licencia <a href="https://github.com/Pybonacci/pybonacci.github.io/blob/sources/LICENSE.md"> CC BY-SA 4.0 + MIT</a>
              salvo otra indicación.
              <p>Contenido generado con <a href= "http://docs.getpelican.com/">Pelican</a>.</p>
            </p>
          </div>
        </footer>

    </body>
</html>